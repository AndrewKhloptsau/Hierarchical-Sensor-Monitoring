@using HSMServer.Constants
@using HSMServer.HtmlHelpers
@model HSMServer.Model.ViewModel.NodeViewModel

<li id='@Model.EncodedPath' title='@Model.Name &#013;@Model.UpdateTime'
    data-jstree='{"icon" : "fas fa-circle @ViewHelper.GetStatusHeaderColorClass(Model.Status)", "time" : "@Model.UpdateTime.ToString(ViewConstants.NodeUpdateTimeFormat)"}'>
    @Model.GetShortName(Model.Name) (@Model.Count sensors)

    @if (Model.Nodes != null)
        @foreach (var (_, child) in Model.Nodes)
        {
            <ul>@await Html.PartialAsync("_TreeNode", child)</ul>
        }

    @if (Model.Sensors != null && !Model.Sensors.IsEmpty)
    {
        <ul>
            @foreach (var (sensorName, sensor) in Model.Sensors)
            {
                <li id='sensor_@Model.EncodedPath' title='@sensorName &#013;@sensor.Time'
                    data-jstree='{"icon" : "fas fa-circle @ViewHelper.GetStatusHeaderColorClass(sensor.Status)", "time" : "@sensor.Time"}'>
                    @Model.GetShortName(sensorName)
                </li>
            }
        </ul>
    }
</li>
